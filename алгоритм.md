# FlowTask - –ê–ª–≥–æ—Ä–∏—Ç–º REST API –¥–ª—è Bitrix24

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–û–±—â–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è](#–æ–±—â–∞—è-–∫–æ–Ω—Ü–µ–ø—Ü–∏—è)
2. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è](#1-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
3. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö Single Table](#2-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–∞–Ω–Ω—ã—Ö-–≤-single-table-tflow_nodes)
4. [–û—Ç–∫—Ä—ã—Ç–∏–µ –≤–∫–ª–∞–¥–∫–∏ "–ü—Ä–æ—Ü–µ—Å—Å—ã"](#3-–æ—Ç–∫—Ä—ã—Ç–∏–µ-–≤–∫–ª–∞–¥–∫–∏-–ø—Ä–æ—Ü–µ—Å—Å—ã-–≤-–∑–∞–¥–∞—á–µ)
5. [Drag & Drop –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ](#4-drag--drop-–ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ-–∫–∞—Ä—Ç–æ—á–µ–∫)
6. [Pull & Push —Å–æ–±—ã—Ç–∏—è](#5-–æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ-–∏–∑–º–µ–Ω–µ–Ω–∏—è-—Å—Ç–∞—Ç—É—Å–∞-–∑–∞–¥–∞—á–∏-pull--push)
7. [–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∑–∞–¥–∞—á](#6-—Å–æ–∑–¥–∞–Ω–∏–µ-–ø—Ä–µ–¥–∑–∞–¥–∞—á–∏-—Å–≤—è–∑–∏-–º–µ–∂–¥—É-–∑–∞–¥–∞—á–∞–º–∏)
8. [–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤](#8-—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ-–ø—Ä–æ—Ü–µ—Å—Å–∞)
9. [–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤](#9-–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ-—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ-–ø—Ä–æ—Ü–µ—Å—Å–∞-–∫-–∑–∞–¥–∞—á–µ)
10. [–ü–æ–¥–ø–∏—Å–∫–∞ –∏ –æ–ø–ª–∞—Ç–∞](#11-–ø–æ–¥–ø–∏—Å–∫–∞-–∏-–æ–ø–ª–∞—Ç–∞)
11. [–ó–∞–∫–ª—é—á–µ–Ω–∏–µ](#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ)

---

## –û–±—â–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–¥–∞—á –≤ Bitrix24 —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º React Flow. –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ REST API –±–µ–∑ –ø—Ä—è–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –ë–î, –∏—Å–ø–æ–ª—å–∑—É—è Entity Storage —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π **Single Table Design**.

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

üéØ **Single Table Design** - –æ–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ `tflow_nodes` –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
üöÄ **FILTER –ø–æ NAME** - –±—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (5 –∑–∞–ø–∏—Å–µ–π –≤–º–µ—Å—Ç–æ 3000+)
‚ö° **Pull & Push** - –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–¥–∞—á
üé® **React Flow** - –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ—Ç–Ω–æ —Å drag & drop
üîó **–°–≤—è–∑–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã** - –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á –º–æ–≥—É—Ç —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ –æ–¥–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
üí∞ **–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è** - 30 –¥–Ω–µ–π –±–µ—Å–ø–ª–∞—Ç–Ω–æ, –ø–æ—Ç–æ–º 500‚ÇΩ/–º–µ—Å—è—Ü

### –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö:

**NAME (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á):**
```
process_{processId}_node_{nodeType}-{nodeId}
```

**DETAIL_TEXT (JSON —Å –¥–∞–Ω–Ω—ã–º–∏):**
```json
{
  "nodeId": "task-154",
  "type": "task|future",
  "processId": 154,
  "positionX": 400,
  "positionY": 300,
  "edges": [...],
  ...
}
```

---

## 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 1.1 –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ Bitrix24 –ú–∞—Ä–∫–µ—Ç

**–§–∞–π–ª:** `install/index.php` –∏–ª–∏ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

**–¢—Ä–µ–±—É–µ–º—ã–µ –ø—Ä–∞–≤–∞ (scope):**
- `task` - —Ä–∞–±–æ—Ç–∞ —Å –∑–∞–¥–∞—á–∞–º–∏
- `entity` - —Ä–∞–±–æ—Ç–∞ —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º –¥–∞–Ω–Ω—ã—Ö
- `user` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö
- `sonet` - —Ä–∞–±–æ—Ç–∞ —Å –≥—Ä—É–ø–ø–∞–º–∏
- `placement` - –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ –≤–∏–¥–∂–µ—Ç–æ–≤

### 1.2 –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:** `onAppInstall` event

**–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ:**

#### 1.2.1 –°–æ–∑–¥–∞–Ω–∏–µ Entity Storage (Single Table)

**–•—Ä–∞–Ω–∏–ª–∏—â–µ:** `tflow_nodes`

**–ú–µ—Ç–æ–¥:** `entity.add`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "tflow_nodes",
  "NAME": "FlowTask - All Nodes (Single Table)",
  "ACCESS": {
    "AU": "W"
  }
}
```

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Single Table Design:**
- **–û–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞** –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö (–∑–∞–¥–∞—á–∏, –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏, —Å–≤—è–∑–∏)
- **NAME —Ñ–æ—Ä–º–∞—Ç:** `process_{processId}_node_{nodeType}-{nodeId}`
- **DETAIL_TEXT:** JSON —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ —É–∑–ª–∞
- **–ü—Ä–∏–º–µ—Ä—ã NAME:**
  - `process_154_node_task-154` - —Ä–µ–∞–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞ —Å ID 154
  - `process_154_node_future-1761831843661` - –ø—Ä–µ–¥–∑–∞–¥–∞—á–∞ (timestamp)
  - `process_154_node_task-155` - –∑–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–Ω–∞—è –∏–∑ –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –û–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ –≤–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ (nodes, links, pretasks, positions)
- ‚úÖ FILTER –ø–æ NAME –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π –º–∞–ø–ø–∏–Ω–≥ –±–µ–∑ JOIN'–æ–≤
- ‚úÖ –ì–∏–±–∫–∏–µ –∏–º–µ–Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (—á–∏—Å–ª–∞ –∏–ª–∏ —Å—Ç—Ä–æ–∫–∏: "project-alpha")

#### 1.2.2 –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è placement (–≤–∫–ª–∞–¥–∫–∞ "–ü—Ä–æ—Ü–µ—Å—Å—ã")

**–ú–µ—Ç–æ–¥:** `placement.bind`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "PLACEMENT": "TASK_VIEW_TAB",
  "HANDLER": "https://your-app.com/flowtask/index.html",
  "TITLE": "–ü—Ä–æ—Ü–µ—Å—Å—ã",
  "DESCRIPTION": "–í–∏–∑—É–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ –∑–∞–¥–∞—á",
  "OPTIONS": {
    "width": 1200,
    "height": 800
  }
}
```

**–ß—Ç–æ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏:**
```javascript
// –í PLACEMENT_OPTIONS –ø—Ä–∏—Ö–æ–¥–∏—Ç:
{
  "taskId": "286" // ID —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏
}
```

#### 1.2.3 –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è –∑–∞–¥–∞—á

**–ú–µ—Ç–æ–¥:** `event.bind`

**–°–æ–±—ã—Ç–∏—è –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏:**
```json
{
  "event": "ONTASKUPDATE",
  "handler": "https://your-app.com/flowtask/webhook/task-update"
}
```

```json
{
  "event": "ONTASKCOMPLETE",
  "handler": "https://your-app.com/flowtask/webhook/task-complete"
}
```

```json
{
  "event": "ONTASKDELETE",
  "handler": "https://your-app.com/flowtask/webhook/task-delete"
}
```

#### 1.2.4 –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏

**–ú–µ—Ç–æ–¥:** `app.option.set`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "options": {
    "install_date": "2025-10-30",
    "subscription_status": "trial",
    "subscription_expires": "2025-11-30",
    "version": "1.0.0"
  }
}
```

### 1.3 –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ

**–§–∞–π–ª:** `public/index.html`

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
1. –ó–∞–≥—Ä—É–∑–∏—Ç—å BX24 SDK
2. –í—ã–∑–≤–∞—Ç—å `BX24.init()`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ Entity Storage
4. –ï—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - —Å–æ–∑–¥–∞—Ç—å
5. –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏
6. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å Pull & Push –∫–ª–∏–µ–Ω—Ç

```javascript
BX24.init(async function() {
  // 1. –ü–æ–ª—É—á–∏—Ç—å taskId –∏–∑ PLACEMENT_OPTIONS
  const placementOptions = BX24.placement.info();
  const taskId = placementOptions.options.taskId;

  // 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
  const storageExists = await checkEntityStorage('tflow_nodes');

  if (!storageExists) {
    await createEntityStorage();
  }

  // 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
  const subscriptionValid = await checkSubscription();

  if (!subscriptionValid) {
    showPaymentModal();
    return;
  }

  // 4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å Pull –∫–ª–∏–µ–Ω—Ç
  initPullClient();

  // 5. –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å canvas
  loadAndRenderCanvas(taskId);
});
```

---

## 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Single Table (tflow_nodes)

### 2.1 –§–æ—Ä–º–∞—Ç –ø–æ–ª—è NAME

**–®–∞–±–ª–æ–Ω:**
```
process_{processId}_node_{nodeType}-{nodeId}
```

**–¢–∏–ø—ã —É–∑–ª–æ–≤ (nodeType):**
- `task` - —Ä–µ–∞–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞ –∏–∑ Bitrix24
- `future` - –ø—Ä–µ–¥–∑–∞–¥–∞—á–∞ (–±—É–¥—É—â–∞—è –∑–∞–¥–∞—á–∞)
- `edge` - —Å–≤—è–∑—å –º–µ–∂–¥—É —É–∑–ª–∞–º–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ —Ö—Ä–∞–Ω–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ)

**–ü—Ä–∏–º–µ—Ä—ã:**
```
process_154_node_task-154          # –ü–µ—Ä–≤–∞—è –∑–∞–¥–∞—á–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞
process_154_node_future-1761831843661  # –ü—Ä–µ–¥–∑–∞–¥–∞—á–∞ (timestamp)
process_154_node_task-155          # –°–æ–∑–¥–∞–Ω–Ω–∞—è –∏–∑ –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏
process_alpha_node_task-200        # –ü—Ä–æ—Ü–µ—Å—Å —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º ID
```

### 2.2 –§–æ—Ä–º–∞—Ç –ø–æ–ª—è DETAIL_TEXT (JSON)

**–î–ª—è —É–∑–ª–∞ —Ç–∏–ø–∞ "task":**
```json
{
  "nodeId": "task-154",
  "type": "task",
  "title": "–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏",
  "responsibleId": 1,
  "groupId": 125,
  "status": 2,
  "positionX": 400,
  "positionY": 300,
  "realTaskId": 154,
  "processId": 154,
  "color": "#2196F3",
  "createdBy": 1,
  "createdDate": "2025-10-30T10:00:00+00:00"
}
```

**–î–ª—è —É–∑–ª–∞ —Ç–∏–ø–∞ "future" (–ø—Ä–µ–¥–∑–∞–¥–∞—á–∞):**
```json
{
  "nodeId": "future-1761831843661",
  "type": "future",
  "title": "–ë—É–¥—É—â–∞—è –∑–∞–¥–∞—á–∞",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ –±—É–¥—É—â–µ–π –∑–∞–¥–∞—á–∏",
  "responsibleId": 1,
  "groupId": 125,
  "conditionType": "IMMEDIATELY",
  "conditionValue": 0,
  "positionX": 600,
  "positionY": 400,
  "processId": 154,
  "parentTaskId": 154,
  "createdFromTaskId": 0,
  "sourceNodeId": "task-154",
  "edges": [
    {
      "id": "edge-1",
      "source": "task-154",
      "target": "future-1761831843661",
      "type": "default"
    }
  ]
}
```

**–¢–∏–ø—ã —É—Å–ª–æ–≤–∏–π (conditionType):**
- `IMMEDIATELY` - —Å–æ–∑–¥–∞—Ç—å —Å—Ä–∞–∑—É –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏
- `DELAY` - —Å–æ–∑–¥–∞—Ç—å —á–µ—Ä–µ–∑ X –º–∏–Ω—É—Ç (–∑–Ω–∞—á–µ–Ω–∏–µ –≤ `conditionValue`)
- `ON_CANCEL_CANCEL` - –æ—Ç–º–µ–Ω–∏—Ç—å –ø—Ä–µ–¥–∑–∞–¥–∞—á—É –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ –∑–∞–¥–∞—á–∏
- `ON_CANCEL_START` - —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π

### 2.3 –¶–≤–µ—Ç–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–¥–∞—á

**–ú–∞–ø–ø–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–æ–≤ Bitrix24:**
```javascript
const STATUS_COLORS = {
  '1': '#E0E0E0',  // –ù–æ–≤–∞—è - —Å–≤–µ—Ç–ª–æ-—Å–µ—Ä—ã–π
  '2': '#2196F3',  // –í —Ä–∞–±–æ—Ç–µ - —Å–∏–Ω–∏–π
  '3': '#2196F3',  // –ñ–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è - —Å–∏–Ω–∏–π
  '4': '#FF9800',  // –ñ–¥–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è (—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ) - –æ—Ä–∞–Ω–∂–µ–≤—ã–π
  '5': '#4CAF50',  // –í—ã–ø–æ–ª–Ω–µ–Ω–∞ (–≥–æ—Ç–æ–≤–æ) - –∑–µ–ª–µ–Ω—ã–π
  '6': '#F44336',  // –û—Ç–ª–æ–∂–µ–Ω–∞ (–æ—Ç–º–µ–Ω–∞) - –∫—Ä–∞—Å–Ω—ã–π
  '7': '#F44336',  // –û—Ç–∫–ª–æ–Ω–µ–Ω–∞ (–æ—Ç–º–µ–Ω–∞) - –∫—Ä–∞—Å–Ω—ã–π
  'future': '#616161'  // –ü—Ä–µ–¥–∑–∞–¥–∞—á–∞ - —Ç–µ–º–Ω–æ-—Å–µ—Ä—ã–π
};
```

### 2.4 –ü–æ–∏—Å–∫ –ø–æ NAME —á–µ—Ä–µ–∑ FILTER

**–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞:**
```javascript
// –ú–µ—Ç–æ–¥: entity.item.get
{
  "ENTITY": "tflow_nodes",
  "FILTER": {
    "%NAME": "process_154"  // % = LIKE –≤ SQL
  }
}
// –í–µ—Ä–Ω–µ—Ç: –≤—Å–µ –∑–∞–ø–∏—Å–∏ —Å NAME –Ω–∞—á–∏–Ω–∞—é—â–∏–º—Å—è –Ω–∞ "process_154"
// –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 3-5 –∑–∞–ø–∏—Å–µ–π –≤–º–µ—Å—Ç–æ 3000+
```

**–ü–æ–∏—Å–∫ –∑–∞–¥–∞—á–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è processId:**
```javascript
// –ú–µ—Ç–æ–¥: entity.item.get
{
  "ENTITY": "tflow_nodes",
  "FILTER": {
    "%NAME": "task-155"  // –Ω–∞–π—Ç–∏ –ª—é–±—É—é –∑–∞–ø–∏—Å—å —Å–æ–¥–µ—Ä–∂–∞—â—É—é task-155
  }
}
// –í–µ—Ä–Ω–µ—Ç: process_154_node_task-155
// –ò–∑–≤–ª–µ—á—å processId —á–µ—Ä–µ–∑ regex: /process_(\w+)_node/
```

---

## 3. –û—Ç–∫—Ä—ã—Ç–∏–µ –≤–∫–ª–∞–¥–∫–∏ "–ü—Ä–æ—Ü–µ—Å—Å—ã" –≤ –∑–∞–¥–∞—á–µ

### 3.1 –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏

**–ê–ª–≥–æ—Ä–∏—Ç–º –∑–∞–≥—Ä—É–∑–∫–∏ (TaskProcessMapping):**

#### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç—å taskId

```javascript
const placementInfo = BX24.placement.info();
const taskId = placementInfo.options.taskId; // "154"
```

#### –®–∞–≥ 2: –ù–∞–π—Ç–∏ –∑–∞–ø–∏—Å—å –∑–∞–¥–∞—á–∏ –≤ tflow_nodes

**–ú–µ—Ç–æ–¥:** `entity.item.get`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "tflow_nodes",
  "FILTER": {
    "%NAME": "task-154"
  }
}
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

**A) –ó–∞–ø–∏—Å—å –Ω–∞–π–¥–µ–Ω–∞:**
```json
{
  "result": [
    {
      "ID": "123",
      "NAME": "process_154_node_task-154",
      "DETAIL_TEXT": "{\"nodeId\":\"task-154\",\"processId\":154,...}"
    }
  ]
}
```

**–ò–∑–≤–ª–µ—á—å processId –∏–∑ NAME:**
```javascript
const namePattern = /process_(\w+)_node/;
const match = name.match(namePattern);
const processId = match ? match[1] : null; // "154"
```

**B) –ó–∞–ø–∏—Å—å –ù–ï –Ω–∞–π–¥–µ–Ω–∞ - –ø–æ–∫–∞–∑–∞—Ç—å ProcessSelector:**

```javascript
// –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞
const processChoice = await showProcessSelector(taskId);

if (processChoice.action === 'create_new') {
  // –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Å –∏–º–µ–Ω–µ–º –∏–∑ —Ñ–æ—Ä–º—ã –∏–ª–∏ taskId
  const processId = processChoice.processName || taskId;
  await createTaskNode(taskId, processId);
} else if (processChoice.action === 'join_existing') {
  // –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É
  const processId = processChoice.selectedProcessId;
  await createTaskNode(taskId, processId);
}
```

#### –®–∞–≥ 3: –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å

**–ú–µ—Ç–æ–¥:** `entity.item.get`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "tflow_nodes",
  "FILTER": {
    "%NAME": "process_154"
  }
}
```

**–û—Ç–≤–µ—Ç:** –í—Å–µ —É–∑–ª—ã –ø—Ä–æ—Ü–µ—Å—Å–∞ (–∑–∞–¥–∞—á–∏, –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏)
```json
{
  "result": [
    {
      "ID": "123",
      "NAME": "process_154_node_task-154",
      "DETAIL_TEXT": "{...task data...}"
    },
    {
      "ID": "124",
      "NAME": "process_154_node_future-1761831843661",
      "DETAIL_TEXT": "{...future task data...}"
    },
    {
      "ID": "125",
      "NAME": "process_154_node_task-155",
      "DETAIL_TEXT": "{...created task data...}"
    }
  ]
}
```

#### –®–∞–≥ 4: –ü–æ–ª—É—á–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á –∏–∑ Bitrix24

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å batch –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**

**–ú–µ—Ç–æ–¥:** `batch`

```javascript
const taskIds = extractTaskIds(nodes); // [154, 155]

const batchCommands = {};
taskIds.forEach(id => {
  batchCommands[`task_${id}`] = `tasks.task.get?taskId=${id}`;
});

// –ü—Ä–∏–º–µ—Ä batch –∑–∞–ø—Ä–æ—Å–∞:
{
  "halt": 0,
  "cmd": {
    "task_154": "tasks.task.get?taskId=154",
    "task_155": "tasks.task.get?taskId=155"
  }
}
```

#### –®–∞–≥ 5: –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å—ã —É–∑–ª–æ–≤

```javascript
// –û–±–Ω–æ–≤–∏—Ç—å —Ü–≤–µ—Ç –∏ —Å—Ç–∞—Ç—É—Å –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞ –∑–∞–¥–∞—á–∏
nodes.forEach(node => {
  if (node.type === 'task') {
    const taskData = batchResult[`task_${node.realTaskId}`];
    node.status = taskData.status;
    node.color = STATUS_COLORS[taskData.status];
    node.title = taskData.title;
  }
});
```

#### –®–∞–≥ 6: –°–æ–∑–¥–∞—Ç—å —É–∑–µ–ª –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

**–ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –æ—Ç–∫—Ä—ã—Ç–∞ –≤–ø–µ—Ä–≤—ã–µ –ò –≤—ã–±—Ä–∞–Ω –ø—Ä–æ—Ü–µ—Å—Å:**

**–ú–µ—Ç–æ–¥:** `entity.item.add`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "tflow_nodes",
  "NAME": "process_154_node_task-154",
  "DETAIL_TEXT": "{\"nodeId\":\"task-154\",\"type\":\"task\",\"title\":\"–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏\",\"realTaskId\":154,\"processId\":154,\"positionX\":400,\"positionY\":300,\"status\":2}"
}
```

### 3.2 ProcessSelector - –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞

**–ö–æ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è:**
- –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∑–∞–¥–∞—á–∏, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ `tflow_nodes`
- –ü—Ä–∏ –∫–ª–∏–∫–µ "–°–º–µ–Ω–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å" (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç:**
```javascript
// ProcessSelector.jsx
function ProcessSelector({ taskId, onSelect }) {
  const [processName, setProcessName] = useState(taskId);
  const [existingProcesses, setExistingProcesses] = useState([]);
  const [selectedAction, setSelectedAction] = useState('create_new');

  useEffect(() => {
    loadExistingProcesses();
  }, []);

  async function loadExistingProcesses() {
    // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Å —Ä–∞–Ω–Ω–µ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π
    const processes = await getAllProcesses();
    setExistingProcesses(processes);
  }

  function handleSubmit() {
    if (selectedAction === 'create_new') {
      onSelect({
        action: 'create_new',
        processName: processName || taskId
      });
    } else {
      onSelect({
        action: 'join_existing',
        selectedProcessId: selectedProcessId
      });
    }
  }

  return (
    <Dialog>
      <h3>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –∑–∞–¥–∞—á–∏ #{taskId}</h3>

      <RadioGroup value={selectedAction} onChange={setSelectedAction}>
        <Radio value="create_new">
          –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å
          <Input
            placeholder={`–ü—Ä–æ—Ü–µ—Å—Å ${taskId}`}
            value={processName}
            onChange={setProcessName}
          />
        </Radio>

        <Radio value="join_existing">
          –£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
          <Select
            options={existingProcesses}
            onChange={setSelectedProcessId}
          />
        </Radio>
      </RadioGroup>

      <Button onClick={handleSubmit}>–ü—Ä–∏–º–µ–Ω–∏—Ç—å</Button>
      <Button onClick={onCancel}>–û—Ç–º–µ–Ω–∞</Button>
    </Dialog>
  );
}
```

### 3.3 –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Å —Ä–∞–Ω–Ω–µ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ 3 –±–∞—Ç—á–µ–π –±–µ–∑ –Ω–æ–≤—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

```javascript
async function getAllProcesses() {
  const processes = new Set();
  let start = 0;
  const batchSize = 50;
  let consecutiveEmptyBatches = 0;
  const maxEmptyBatches = 3;

  while (consecutiveEmptyBatches < maxEmptyBatches) {
    const result = await BX24.callMethod('entity.item.get', {
      ENTITY: 'tflow_nodes',
      FILTER: { '%NAME': 'process_' },
      start: start
    });

    const items = result.answer.result;
    if (!items || items.length === 0) {
      break;
    }

    // –ò–∑–≤–ª–µ—á—å processId –∏–∑ –∫–∞–∂–¥–æ–≥–æ NAME
    let newProcessesFound = false;
    items.forEach(item => {
      const match = item.NAME.match(/process_(\w+)_node/);
      if (match) {
        const processId = match[1];
        const sizeBefore = processes.size;
        processes.add(processId);
        if (processes.size > sizeBefore) {
          newProcessesFound = true;
        }
      }
    });

    if (!newProcessesFound) {
      consecutiveEmptyBatches++;
    } else {
      consecutiveEmptyBatches = 0;
    }

    start += batchSize;
  }

  return Array.from(processes);
}
```

### 3.4 –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –ø–æ–ª–æ—Ç–Ω–µ

**React Flow nodes:**

```javascript
// –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ tflow_nodes –≤ React Flow —Ñ–æ—Ä–º–∞—Ç
function transformToReactFlowNodes(entities) {
  const nodes = [];
  const edges = [];

  entities.forEach(entity => {
    const data = JSON.parse(entity.DETAIL_TEXT);

    if (data.type === 'task') {
      nodes.push({
        id: data.nodeId,
        type: 'taskNode',
        position: { x: data.positionX, y: data.positionY },
        data: {
          ...data,
          color: STATUS_COLORS[data.status] || '#E0E0E0',
          entityId: entity.ID
        }
      });
    } else if (data.type === 'future') {
      nodes.push({
        id: data.nodeId,
        type: 'futureNode',
        position: { x: data.positionX, y: data.positionY },
        data: {
          ...data,
          color: data.createdFromTaskId > 0 ? '#BDBDBD' : '#616161',
          entityId: entity.ID
        }
      });

      // –ò–∑–≤–ª–µ—á—å —Å–≤—è–∑–∏ –∏–∑ edges –º–∞—Å—Å–∏–≤–∞
      if (data.edges) {
        data.edges.forEach(edge => {
          edges.push({
            id: edge.id,
            source: edge.source,
            target: edge.target,
            type: edge.type || 'default'
          });
        });
      }
    }
  });

  return { nodes, edges };
}
```

**–¶–≤–µ—Ç–∞ —É–∑–ª–æ–≤:**
- **–†–µ–∞–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞:** —Ü–≤–µ—Ç –ø–æ —Å—Ç–∞—Ç—É—Å—É –∏–∑ Bitrix24
  - –°—Ç–∞—Ç—É—Å 1 (–ù–æ–≤–∞—è): `#E0E0E0` (—Å–≤–µ—Ç–ª–æ-—Å–µ—Ä—ã–π)
  - –°—Ç–∞—Ç—É—Å 2-3 (–í —Ä–∞–±–æ—Ç–µ): `#2196F3` (—Å–∏–Ω–∏–π)
  - –°—Ç–∞—Ç—É—Å 4 (–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ): `#FF9800` (–æ—Ä–∞–Ω–∂–µ–≤—ã–π)
  - –°—Ç–∞—Ç—É—Å 5 (–ì–æ—Ç–æ–≤–æ): `#4CAF50` (–∑–µ–ª–µ–Ω—ã–π)
  - –°—Ç–∞—Ç—É—Å 6-7 (–û—Ç–º–µ–Ω–∞): `#F44336` (–∫—Ä–∞—Å–Ω—ã–π)
- **–ü—Ä–µ–¥–∑–∞–¥–∞—á–∞ (–Ω–µ —Å–æ–∑–¥–∞–Ω–∞):** `#616161` (—Ç–µ–º–Ω–æ-—Å–µ—Ä—ã–π)
- **–ü—Ä–µ–¥–∑–∞–¥–∞—á–∞ (—Å–æ–∑–¥–∞–Ω–∞ –∑–∞–¥–∞—á–∞):** `#BDBDBD` (—Å–≤–µ—Ç–ª–æ-—Å–µ—Ä—ã–π)

---

## 4. Drag & Drop –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫

### 4.1 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ —É–∑–ª–∞

**–°–æ–±—ã—Ç–∏–µ:** `onNodeDragStop` –≤ React Flow

```javascript
function onNodeDragStop(event, node) {
  const newPosition = node.position;

  // –û–±–Ω–æ–≤–∏—Ç—å –≤ tflow_nodes
  updateNodePosition(node.data.entityId, newPosition.x, newPosition.y);
}
```

**–ú–µ—Ç–æ–¥:** `entity.item.update`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "tflow_nodes",
  "ID": "123",
  "DETAIL_TEXT": "{\"nodeId\":\"task-154\",\"positionX\":450.5,\"positionY\":320.8,...–æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è...}"
}
```

**–í–∞–∂–Ω–æ:**
- –ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –≤–µ—Å—å JSON –≤ `DETAIL_TEXT`
- –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π JSON, –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ `positionX` –∏ `positionY`
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—Ä–∞—Ç–Ω–æ

```javascript
async function updateNodePosition(entityId, newX, newY) {
  // 1. –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é –∑–∞–ø–∏—Å—å
  const result = await BX24.callMethod('entity.item.get', {
    ENTITY: 'tflow_nodes',
    ID: entityId
  });

  const entity = result.answer.result[0];
  const nodeData = JSON.parse(entity.DETAIL_TEXT);

  // 2. –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é
  nodeData.positionX = newX;
  nodeData.positionY = newY;

  // 3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—Ä–∞—Ç–Ω–æ
  await BX24.callMethod('entity.item.update', {
    ENTITY: 'tflow_nodes',
    ID: entityId,
    DETAIL_TEXT: JSON.stringify(nodeData)
  });
}
```

### 4.2 –î–µ–±–∞—É–Ω—Å –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

**–ù–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø–∏–∫—Å–µ–ª–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è:**

```javascript
const debouncedUpdatePosition = debounce((entityId, x, y) => {
  updateNodePosition(entityId, x, y);
}, 500); // –°–æ—Ö—Ä–∞–Ω—è—Ç—å —á–µ—Ä–µ–∑ 500–º—Å –ø–æ—Å–ª–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

function onNodeDrag(event, node) {
  // –û–±–Ω–æ–≤–∏—Ç—å UI —Å—Ä–∞–∑—É
  reactFlowInstance.setNodes((nodes) =>
    nodes.map((n) =>
      n.id === node.id ? { ...n, position: node.position } : n
    )
  );

  // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ë–î —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
  debouncedUpdatePosition(node.data.entityId, node.position.x, node.position.y);
}
```

---

## 5. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏ (Pull & Push)

### 5.1 –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è –∑–∞–¥–∞—á

**JavaScript –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞:**

```javascript
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Pull –∫–ª–∏–µ–Ω—Ç–∞
BX24.init(function() {
  if (typeof BX.PULL !== 'undefined') {
    BX.PULL.subscribe({
      moduleId: 'tasks',
      command: 'task_update',
      callback: function(data) {
        // data —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –∑–∞–¥–∞—á–µ
        if (data.params && data.params.TASK_ID) {
          updateTaskStatusOnCanvas(data.params.TASK_ID, data.params.STATUS);
        }
      }
    });
  }
});

// –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ –ø–æ–ª–æ—Ç–Ω–µ
function updateTaskStatusOnCanvas(taskId, newStatus) {
  // –ù–∞–π—Ç–∏ –∫–∞—Ä—Ç–æ—á–∫—É –∑–∞–¥–∞—á–∏ –Ω–∞ –ø–æ–ª–æ—Ç–Ω–µ
  const cardNode = reactFlowInstance.getNode(`task-${taskId}`);

  if (cardNode) {
    // –û–±–Ω–æ–≤–∏—Ç—å —Ü–≤–µ—Ç –∫–∞—Ä—Ç–æ—á–∫–∏
    const colorMap = {
      '1': '#E0E0E0', // –ù–æ–≤–æ–µ
      '2': '#2196F3', // –í —Ä–∞–±–æ—Ç–µ
      '3': '#2196F3', // –ñ–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (—Ç–æ–∂–µ —Å–∏–Ω–∏–π)
      '4': '#FF9800', // –ñ–¥–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è (—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ)
      '5': '#4CAF50', // –í—ã–ø–æ–ª–Ω–µ–Ω–∞
      '6': '#F44336', // –û—Ç–ª–æ–∂–µ–Ω–∞
      '7': '#F44336'  // –û—Ç–∫–ª–æ–Ω–µ–Ω–∞
    };

    // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∏–ª—å —É–∑–ª–∞
    reactFlowInstance.setNodes((nodes) =>
      nodes.map((node) =>
        node.id === `task-${taskId}`
          ? { ...node, data: { ...node.data, color: colorMap[newStatus] } }
          : node
      )
    );

    // –û–±–Ω–æ–≤–∏—Ç—å –≤ Entity
    updateTaskStatusInEntity(taskId, newStatus);

    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å–ª–æ–≤–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
    checkAndCreateLinkedTasks(taskId, newStatus);
  }
}
```

### 5.2 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –≤ Entity

**–ú–µ—Ç–æ–¥:** `entity.item.update`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "flowtask_cards",
  "ID": "card_id",
  "PROPERTY_VALUES": {
    "status": "COMPLETED"
  }
}
```

### 5.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞—á

**–ê–ª–≥–æ—Ä–∏—Ç–º:**

1. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å–≤—è–∑–∏, –≥–¥–µ `source_id` = ID —Ç–µ–∫—É—â–µ–π –∫–∞—Ä—Ç–æ—á–∫–∏
2. –î–ª—è –∫–∞–∂–¥–æ–π —Å–≤—è–∑–∏ –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥–∑–∞–¥–∞—á—É –∏–∑ `target_id`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `condition_type`:
   - `IMMEDIATELY` - —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É —Å—Ä–∞–∑—É –ø—Ä–∏ —Å—Ç–∞—Ç—É—Å–µ "–ì–æ—Ç–æ–≤–æ" (5)
   - `DELAY` - —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É —á–µ—Ä–µ–∑ X –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ —Å—Ç–∞—Ç—É—Å–∞ "–ì–æ—Ç–æ–≤–æ"
   - `ON_CANCEL_CANCEL` - –æ—Ç–º–µ–Ω–∏—Ç—å –ø—Ä–µ–¥–∑–∞–¥–∞—á—É –µ—Å–ª–∏ —Å—Ç–∞—Ç—É—Å "–û—Ç–º–µ–Ω–µ–Ω–∞" (6,7)
   - `ON_CANCEL_START` - —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É –µ—Å–ª–∏ —Å—Ç–∞—Ç—É—Å "–û—Ç–º–µ–Ω–µ–Ω–∞"

**–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∏–∑ –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏:**

**–ú–µ—Ç–æ–¥:** `tasks.task.add`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "fields": {
    "TITLE": "pretask.title",
    "DESCRIPTION": "pretask.description",
    "RESPONSIBLE_ID": "pretask.responsible_id",
    "GROUP_ID": "pretask.group_id",
    "CREATED_BY": "current_user_id"
  }
}
```

**–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏ –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–¥–∑–∞–¥–∞—á—É:**

**–ú–µ—Ç–æ–¥:** `entity.item.update`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "flowtask_pretasks",
  "ID": "pretask_id",
  "PROPERTY_VALUES": {
    "created_from_task_id": "new_task_id"
  }
}
```

**–°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É –¥–ª—è –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏:**

**–ú–µ—Ç–æ–¥:** `entity.item.add`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "flowtask_cards",
  "NAME": "Task new_task_id",
  "PROPERTY_VALUES": {
    "task_id": "new_task_id",
    "position_x": "pretask.position_x",
    "position_y": "pretask.position_y",
    "process_id": "pretask.process_id",
    "is_pretask": "Y",
    "status": "NEW"
  }
}
```

---

## 6. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏ (—Å–≤—è–∑–∏ –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏)

### 6.1 –î–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. –ö–ª–∏–∫–∞–µ—Ç –Ω–∞ —Ç–æ—á–∫—É (handle) –Ω–∞ –≥—Ä–∞–Ω–∏ –∫–∞—Ä—Ç–æ—á–∫–∏
2. –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–µ—Ç –ª–∏–Ω–∏—é
3. –û—Ç–ø—É—Å–∫–∞–µ—Ç –≤ –Ω—É–∂–Ω–æ–º –º–µ—Å—Ç–µ
4. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å —Ñ–æ—Ä–º–æ–π

**–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ (FutureTaskModal):**
```javascript
<Dialog>
  <h3>–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏</h3>

  <Input label="–ù–∞–∑–≤–∞–Ω–∏–µ" value={title} onChange={setTitle} />
  <Textarea label="–û–ø–∏—Å–∞–Ω–∏–µ" value={description} onChange={setDescription} />

  <Select label="–ì—Ä—É–ø–ø–∞" options={groups} value={groupId} onChange={setGroupId} />
  <Select label="–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π" options={users} value={responsibleId} onChange={setResponsibleId} />

  <Select label="–£—Å–ª–æ–≤–∏–µ" value={conditionType} onChange={setConditionType}>
    <option value="IMMEDIATELY">–°—Ä–∞–∑—É –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏</option>
    <option value="DELAY">–ß–µ—Ä–µ–∑ X –º–∏–Ω—É—Ç</option>
    <option value="ON_CANCEL_CANCEL">–ü—Ä–∏ –æ—Ç–º–µ–Ω–µ - –æ—Ç–º–µ–Ω–∏—Ç—å</option>
    <option value="ON_CANCEL_START">–ü—Ä–∏ –æ—Ç–º–µ–Ω–µ - –∑–∞–ø—É—Å—Ç–∏—Ç—å</option>
  </Select>

  {conditionType === 'DELAY' && (
    <Input type="number" label="–ß–µ—Ä–µ–∑ —Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç" value={conditionValue} onChange={setConditionValue} />
  )}

  <Button onClick={handleSave}>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</Button>
  <Button onClick={handleCancel}>–û—Ç–º–µ–Ω–∞</Button>
</Dialog>
```

### 6.2 –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏ –≤ Single Table

**–ú–µ—Ç–æ–¥:** `entity.item.add`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "tflow_nodes",
  "NAME": "process_154_node_future-1761831843661",
  "DETAIL_TEXT": "{\"nodeId\":\"future-1761831843661\",\"type\":\"future\",\"title\":\"–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞\",\"description\":\"–û–ø–∏—Å–∞–Ω–∏–µ\",\"responsibleId\":1,\"groupId\":10,\"conditionType\":\"IMMEDIATELY\",\"conditionValue\":0,\"positionX\":800.5,\"positionY\":450.2,\"processId\":154,\"parentTaskId\":154,\"createdFromTaskId\":0,\"sourceNodeId\":\"task-154\",\"edges\":[{\"id\":\"edge-abc123\",\"source\":\"task-154\",\"target\":\"future-1761831843661\",\"type\":\"default\"}]}"
}
```

**–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ NAME:**
```javascript
const timestamp = Date.now();
const futureNodeId = `future-${timestamp}`;
const processId = currentProcessId; // –ò–∑ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –∑–∞–¥–∞—á–∏
const name = `process_${processId}_node_${futureNodeId}`;
```

**–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ DETAIL_TEXT:**
```javascript
const nodeData = {
  nodeId: futureNodeId,
  type: 'future',
  title: formData.title,
  description: formData.description,
  responsibleId: formData.responsibleId,
  groupId: formData.groupId,
  conditionType: formData.conditionType,
  conditionValue: formData.conditionValue || 0,
  positionX: dropPosition.x,
  positionY: dropPosition.y,
  processId: processId,
  parentTaskId: sourceNode.realTaskId,
  createdFromTaskId: 0,
  sourceNodeId: sourceNode.nodeId,
  edges: [
    {
      id: `edge-${Date.now()}`,
      source: sourceNode.nodeId,
      target: futureNodeId,
      type: 'default'
    }
  ]
};

const detailText = JSON.stringify(nodeData);
```

### 6.3 –°–≤—è–∑–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ —É–∑–ª–∞

**–í Single Table Design —Å–≤—è–∑–∏ (edges) —Ö—Ä–∞–Ω—è—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏ –≤ –ø–æ–ª–µ `edges`:**

```json
{
  "edges": [
    {
      "id": "edge-1",
      "source": "task-154",
      "target": "future-1761831843661",
      "type": "default"
    }
  ]
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ù–µ –Ω—É–∂–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è —Å–≤—è–∑–µ–π
- ‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ —É–∑–ª–∞ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- ‚úÖ –õ–µ–≥–∫–æ —É–¥–∞–ª–∏—Ç—å —É–∑–µ–ª –≤–º–µ—Å—Ç–µ —Å–æ —Å–≤—è–∑—è–º–∏

### 6.4 –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –ø–æ–ª–æ—Ç–Ω–µ

```javascript
async function createFutureTask(sourceNode, formData, dropPosition) {
  const timestamp = Date.now();
  const futureNodeId = `future-${timestamp}`;
  const processId = sourceNode.processId;

  // –°–æ–∑–¥–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —É–∑–ª–∞
  const nodeData = {
    nodeId: futureNodeId,
    type: 'future',
    ...formData,
    positionX: dropPosition.x,
    positionY: dropPosition.y,
    processId: processId,
    createdFromTaskId: 0,
    edges: [{
      id: `edge-${timestamp}`,
      source: sourceNode.nodeId,
      target: futureNodeId,
      type: 'default'
    }]
  };

  // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ tflow_nodes
  const result = await BX24.callMethod('entity.item.add', {
    ENTITY: 'tflow_nodes',
    NAME: `process_${processId}_node_${futureNodeId}`,
    DETAIL_TEXT: JSON.stringify(nodeData)
  });

  // –î–æ–±–∞–≤–∏—Ç—å –Ω–∞ canvas
  reactFlowInstance.addNodes({
    id: futureNodeId,
    type: 'futureNode',
    position: dropPosition,
    data: {
      ...nodeData,
      color: '#616161',
      entityId: result.answer.result
    }
  });

  // –î–æ–±–∞–≤–∏—Ç—å —Å–≤—è–∑—å –Ω–∞ canvas
  reactFlowInstance.addEdges({
    id: nodeData.edges[0].id,
    source: sourceNode.nodeId,
    target: futureNodeId,
    type: 'default'
  });
}
```

---

## 7. –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –ø—Ä–µ–¥–∑–∞–¥–∞—á–∞–º–∏

**–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø.6, –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ü–µ–ø–æ—á–∫–∏ –ø—Ä–µ–¥–∑–∞–¥–∞—á:**

```
task-154 ‚Üí future-1 ‚Üí future-2 ‚Üí future-3
```

**–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–≤—è–∑–∏ –æ—Ç –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏:**
```javascript
// –û–±–Ω–æ–≤–∏—Ç—å edges –º–∞—Å—Å–∏–≤ –≤ –∏—Å—Ö–æ–¥–Ω–æ–π –ø—Ä–µ–¥–∑–∞–¥–∞—á–µ
const sourceFutureNode = await getNode(sourceFutureNodeId);
sourceFutureNode.edges.push({
  id: `edge-${Date.now()}`,
  source: sourceFutureNode.nodeId,
  target: targetFutureNodeId,
  type: 'default'
});

// –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ tflow_nodes
await BX24.callMethod('entity.item.update', {
  ENTITY: 'tflow_nodes',
  ID: sourceFutureNode.entityId,
  DETAIL_TEXT: JSON.stringify(sourceFutureNode)
});
```

---

## 8. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞

### 8.1 –£—Å–ª–æ–≤–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

**–ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º:**

1. –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –º–∏–Ω–∏–º—É–º –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞ (–Ω–µ –ø—Ä–µ–¥–∑–∞–¥–∞—á–∞)
2. –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —É–∑–ª—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–µ–¥–∑–∞–¥–∞—á–∞–º–∏
3. –ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∏–∑ –ø—Ä–µ–¥–∑–∞–¥–∞—á, –ø–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É

**–ú–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏:**

```javascript
function canSaveProcess(nodes) {
  let taskCount = 0;
  let createdTasksCount = 0;

  for (const node of nodes) {
    if (node.data.type === 'task' && !node.data.isPretask) {
      taskCount++;
    }
    if (node.data.type === 'task' && node.data.isPretask && node.data.createdFromTaskId > 0) {
      createdTasksCount++;
    }
  }

  if (createdTasksCount > 0) {
    return {
      canSave: false,
      error: "–ü—Ä–æ—Ü–µ—Å—Å –≤–æ–∑–º–æ–∂–µ–Ω —Ç–æ–ª—å–∫–æ –∏–∑ –ø—Ä–µ–¥–∑–∞–¥–∞—á –±–µ–∑ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞—á"
    };
  }

  if (taskCount === 0) {
    return {
      canSave: false,
      error: "–ü—Ä–æ—Ü–µ—Å—Å –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Ö–æ—Ç—è –±—ã —Å –æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏"
    };
  }

  return { canSave: true };
}
```

### 8.2 –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞

**–ú–µ—Ç–æ–¥:** `entity.item.add`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "flowtask_processes",
  "NAME": "–ü—Ä–æ—Ü–µ—Å—Å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤",
  "PROPERTY_VALUES": {
    "name": "–ü—Ä–æ—Ü–µ—Å—Å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤",
    "created_by": 1,
    "created_date": "2025-10-30T10:00:00+00:00",
    "is_template": "Y"
  }
}
```

**–û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç `process_id`.**

### 8.3 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–µ–¥–∑–∞–¥–∞—á –∏ —Å–≤—è–∑–µ–π

**–î–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏:**

**–ú–µ—Ç–æ–¥:** `entity.item.update`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "flowtask_pretasks",
  "ID": "pretask_id",
  "PROPERTY_VALUES": {
    "process_id": "new_process_id"
  }
}
```

**–î–ª—è –∫–∞–∂–¥–æ–π —Å–≤—è–∑–∏:**

**–ú–µ—Ç–æ–¥:** `entity.item.update`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "flowtask_links",
  "ID": "link_id",
  "PROPERTY_VALUES": {
    "process_id": "new_process_id"
  }
}
```

---

## 9. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∫ –∑–∞–¥–∞—á–µ

### 9.1 –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

**–ú–µ—Ç–æ–¥:** `entity.item.get`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "flowtask_processes",
  "FILTER": {
    "is_template": "Y"
  }
}
```

### 9.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —É —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏ –Ω–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ "–≤ –ø—Ä–∞–≤–æ":**

**–ú–µ—Ç–æ–¥:** `entity.item.get`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "flowtask_links",
  "FILTER": {
    "source_id": "current_card_id",
    "source_type": "TASK"
  }
}
```

**–ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã —Å–≤—è–∑–∏:**
```
–ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É: "–ú–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ –∑–∞–¥–∞—á–∏ –±–µ–∑ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤ –ø—Ä–∞–≤–æ"
```

### 9.3 –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–∑–∞–¥–∞—á –ø—Ä–æ—Ü–µ—Å—Å–∞

**–®–∞–≥ 1:** –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞

**–ú–µ—Ç–æ–¥:** `entity.item.get`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "flowtask_pretasks",
  "FILTER": {
    "process_id": "selected_process_id"
  }
}
```

**–®–∞–≥ 2:** –î–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏ —Å–æ–∑–¥–∞—Ç—å –∫–æ–ø–∏—é

**–ú–µ—Ç–æ–¥:** `entity.item.add`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "flowtask_pretasks",
  "NAME": "Pretask copy",
  "PROPERTY_VALUES": {
    "title": "pretask.title",
    "description": "pretask.description",
    "group_id": "pretask.group_id",
    "responsible_id": "pretask.responsible_id",
    "condition_type": "pretask.condition_type",
    "condition_value": "pretask.condition_value",
    "position_x": "pretask.position_x + offset",
    "position_y": "pretask.position_y",
    "process_id": "new_unique_process_id",
    "created_from_task_id": 0,
    "parent_task_id": "current_task_id"
  }
}
```

**–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–∞–ø–ø–∏–Ω–≥:** `old_pretask_id -> new_pretask_id`

### 9.4 –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤—è–∑–µ–π

**–®–∞–≥ 1:** –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å–≤—è–∑–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞

**–ú–µ—Ç–æ–¥:** `entity.item.get`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "flowtask_links",
  "FILTER": {
    "process_id": "selected_process_id"
  }
}
```

**–®–∞–≥ 2:** –î–ª—è –∫–∞–∂–¥–æ–π —Å–≤—è–∑–∏ —Å–æ–∑–¥–∞—Ç—å –∫–æ–ø–∏—é —Å –Ω–æ–≤—ã–º–∏ ID

**–ú–µ—Ç–æ–¥:** `entity.item.add`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "flowtask_links",
  "NAME": "Link copy",
  "PROPERTY_VALUES": {
    "source_id": "mapped_new_source_id OR current_card_id",
    "target_id": "mapped_new_target_id",
    "source_type": "link.source_type",
    "target_type": "link.target_type",
    "process_id": "new_unique_process_id"
  }
}
```

### 9.5 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≥—Ä—É–ø–ø

**–ü—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**

1. –°—É—â–µ—Å—Ç–≤—É—é—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ `responsible_id`
2. –°—É—â–µ—Å—Ç–≤—É—é—Ç –ª–∏ –≥—Ä—É–ø–ø—ã –∏–∑ `group_id`

**–ú–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**

**–ú–µ—Ç–æ–¥:** `user.get`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ID": "responsible_id"
}
```

**–ú–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥—Ä—É–ø–ø—ã:**

**–ú–µ—Ç–æ–¥:** `sonet_group.get`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ID": "group_id"
}
```

**–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–ª–∏ –≥—Ä—É–ø–ø–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã:**

–ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ:
```
"–í –ø—Ä–µ–¥–∑–∞–¥–∞—á–µ [–ù–∞–∑–≤–∞–Ω–∏–µ] –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ/–≥—Ä—É–ø–ø—ã –±–æ–ª—å—à–µ –Ω–µ—Ç.
–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–≤–æ–≥–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ/–≥—Ä—É–ø–ø—É:"

[–í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π/–≥—Ä—É–ø–ø]

[–ü—Ä–∏–º–µ–Ω–∏—Ç—å]  [–û—Ç–º–µ–Ω–∞]
```

**–û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–¥–∑–∞–¥–∞—á—É –Ω–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º:**

**–ú–µ—Ç–æ–¥:** `entity.item.update`

---

## 10. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏

### 10.1 –°–ø–∏—Å–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

**–ú–µ—Ç–æ–¥:** `entity.item.get`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "flowtask_processes",
  "FILTER": {
    "is_template": "Y"
  }
}
```

### 10.2 –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞

**–ú–µ—Ç–æ–¥:** `entity.item.update`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "flowtask_processes",
  "ID": "process_id",
  "PROPERTY_VALUES": {
    "name": "–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞"
  }
}
```

### 10.3 –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞

**–®–∞–≥ 1:** –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞

**–ú–µ—Ç–æ–¥:** `entity.item.delete` (–¥–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏)

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "flowtask_pretasks",
  "ID": "pretask_id"
}
```

**–®–∞–≥ 2:** –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–≤—è–∑–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞

**–ú–µ—Ç–æ–¥:** `entity.item.delete` (–¥–ª—è –∫–∞–∂–¥–æ–π —Å–≤—è–∑–∏)

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "flowtask_links",
  "ID": "link_id"
}
```

**–®–∞–≥ 3:** –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å

**–ú–µ—Ç–æ–¥:** `entity.item.delete`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "ENTITY": "flowtask_processes",
  "ID": "process_id"
}
```

### 10.4 –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞

**–°–ø–æ—Å–æ–±:**
1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –∫ –ª—é–±–æ–π –∑–∞–¥–∞—á–µ
2. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏ –∏ —Å–≤—è–∑–∏
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ –Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Å –¥—Ä—É–≥–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º
4. –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π –ø—Ä–æ—Ü–µ—Å—Å

---

## 11. –ü–æ–¥–ø–∏—Å–∫–∞ –∏ –æ–ø–ª–∞—Ç–∞

### 11.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏

**–ú–µ—Ç–æ–¥:** `app.info`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –Ω–µ—Ç

**–û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç:**
- `LICENSE` - —Ç–∏–ø –ª–∏—Ü–µ–Ω–∑–∏–∏ –ø–æ—Ä—Ç–∞–ª–∞
- –î–∞—Ç–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–õ–æ–≥–∏–∫–∞:**
- –ü–æ–ª—É—á–∏—Ç—å –¥–∞—Ç—É —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–∑ `app.info` –∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
- –°—Ä–∞–≤–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É —Å –¥–∞—Ç–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- –ï—Å–ª–∏ –ø—Ä–æ—à–ª–æ > 30 –¥–Ω–µ–π, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –æ–ø–ª–∞—Ç—ã

### 11.2 –•—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–¥–ø–∏—Å–∫–µ

**–ú–µ—Ç–æ–¥:** `app.option.set`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "options": {
    "install_date": "2025-10-30",
    "subscription_status": "active",
    "subscription_expires": "2025-11-30"
  }
}
```

**–ú–µ—Ç–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è:**

**–ú–µ—Ç–æ–¥:** `app.option.get`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "option": "subscription_status"
}
```

### 11.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏

```javascript
function checkSubscription() {
  BX24.callMethod('app.option.get', {}, function(result) {
    const options = result.data();
    const installDate = new Date(options.install_date);
    const now = new Date();
    const daysPassed = Math.floor((now - installDate) / (1000 * 60 * 60 * 24));

    if (daysPassed > 30) {
      const subscriptionStatus = options.subscription_status;
      const expiresDate = new Date(options.subscription_expires);

      if (subscriptionStatus !== 'active' || now > expiresDate) {
        showPaymentModal();
        return false;
      }
    }

    return true;
  });
}

function showPaymentModal() {
  // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ–ø–ª–∞—Ç–µ
  // "–ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –∑–∞–∫–æ–Ω—á–∏–ª—Å—è. –°—Ç–æ–∏–º–æ—Å—Ç—å: 500 —Ä—É–±/–º–µ—Å—è—Ü"
  // [–û–ø–ª–∞—Ç–∏—Ç—å] [–ó–∞–∫—Ä—ã—Ç—å]

  // –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ "–û–ø–ª–∞—Ç–∏—Ç—å" –æ—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã
  // –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –æ–ø–ª–∞—Ç—ã Bitrix24
}
```

### 11.4 –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–ø–ª–∞—Ç—ã

**–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å:**

**–ú–µ—Ç–æ–¥:** `app.option.set`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "options": {
    "subscription_status": "active",
    "subscription_expires": "2025-12-30"
  }
}
```

---

## 12. Batch-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

–î–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `batch`:

**–ü—Ä–∏–º–µ—Ä –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏:**

**–ú–µ—Ç–æ–¥:** `batch`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "halt": 0,
  "cmd": {
    "task": "tasks.task.get?taskId=286",
    "card": "entity.item.get?ENTITY=flowtask_cards&FILTER[task_id]=286",
    "pretasks": "entity.item.get?ENTITY=flowtask_pretasks&FILTER[parent_task_id]=286",
    "links": "entity.item.get?ENTITY=flowtask_links"
  }
}
```

**–û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ.**

---

## 13. –°–æ–±—ã—Ç–∏—è –∏ –ø–æ–¥–ø–∏—Å–∫–∏

### 13.1 –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á

**–ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**

**–ú–µ—Ç–æ–¥:** `event.bind`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "event": "ONTASKUPDATE",
  "handler": "https://your-app.com/flowtask/webhook/task-update"
}
```

### 13.2 –û–±—Ä–∞–±–æ—Ç–∫–∞ webhook –æ—Ç Bitrix24

**–ö–æ–≥–¥–∞ –∑–∞–¥–∞—á–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è, Bitrix24 –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ handler.**

**–î–∞–Ω–Ω—ã–µ –≤ –∑–∞–ø—Ä–æ—Å–µ:**
```json
{
  "event": "ONTASKUPDATE",
  "data": {
    "FIELDS_BEFORE": {
      "ID": "286",
      "STATUS": "2"
    },
    "FIELDS_AFTER": {
      "ID": "286",
      "STATUS": "5"
    }
  }
}
```

**–í–∞—à —Å–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
2. –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–∏–ª—Å—è, –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —É—Å–ª–æ–≤–∏–π
3. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ –∏–∑ –ø—Ä–µ–¥–∑–∞–¥–∞—á –ø–æ —É—Å–ª–æ–≤–∏—è–º
4. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ —á–µ—Ä–µ–∑ Pull & Push –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–ª–æ—Ç–Ω–∞

---

## 14. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### Frontend (React + React Flow)
- `App.jsx` - –≥–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- `FlowCanvas.jsx` - –ø–æ–ª–æ—Ç–Ω–æ React Flow
- `TaskNode.jsx` - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ –∑–∞–¥–∞—á–∏
- `PretaskNode.jsx` - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏
- `PretaskModal.jsx` - –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏
- `ProcessList.jsx` - —Å–ø–∏—Å–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- `SubscriptionCheck.jsx` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏

### Backend (Node.js/PHP)
- `webhook-handler.js` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏–π –æ—Ç Bitrix24
- `task-creator.js` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –∏–∑ –ø—Ä–µ–¥–∑–∞–¥–∞—á
- `subscription-manager.js` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏
- `entity-manager.js` - —Ä–∞–±–æ—Ç–∞ —Å Entity —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º–∏

### API —Å–ª–æ–π
- `bitrix-api.js` - –æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è REST API Bitrix24
- `batch-requests.js` - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ batch
- `pull-client.js` - —Ä–∞–±–æ—Ç–∞ —Å Pull & Push

---

## 15. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ Bitrix24**
   - –°–æ–∑–¥–∞—Ç—å —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ Entity: `flowtask_cards`, `flowtask_links`, `flowtask_pretasks`, `flowtask_processes`
   - –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å placement `TASK_VIEW_TAB`
   - –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è `ONTASKUPDATE`
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞—Ç—É —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ `app.option.set`

2. **–ü–µ—Ä–≤–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –≤–∫–ª–∞–¥–∫–∏ "–ü—Ä–æ—Ü–µ—Å—Å—ã"**
   - –ü–æ–ª—É—á–∏—Ç—å `taskId` –∏–∑ `PLACEMENT_OPTIONS`
   - –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ —á–µ—Ä–µ–∑ `tasks.task.get`
   - –°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É –≤ `flowtask_cards` –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
   - –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ø–æ–ª–æ—Ç–Ω–æ —Å –æ–¥–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–æ–π –≤ —Ü–µ–Ω—Ç—Ä–µ

3. **–°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏
   - –°–≤—è–∑—ã–≤–∞–µ—Ç –∏—Ö –ª–∏–Ω–∏—è–º–∏
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å
   - –ü—Ä–æ—Ü–µ—Å—Å –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫ –¥—Ä—É–≥–∏–º –∑–∞–¥–∞—á–∞–º

---

## 16. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 16.1 –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
```javascript
if (result.error() && result.error().error === 'WRONG_AUTH_TYPE') {
  // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
  BX24.refreshAuth();
}
```

### 16.2 –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ Entity
```javascript
if (result.error() && result.error().error === 'ERROR_CORE') {
  // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
  // –ï—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - —Å–æ–∑–¥–∞—Ç—å
  createEntityStorage();
}
```

### 16.3 –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏
```javascript
if (result.error() && result.error().error === 'ERROR_TASK_ADD') {
  // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
  // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–∏
  showError('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É: ' + result.error().error_description);
}
```

---

## 17. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 17.1 –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ 5 –º–∏–Ω—É—Ç
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø –Ω–∞ 5 –º–∏–Ω—É—Ç
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

### 17.2 –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
- –ó–∞–≥—Ä—É–∂–∞—Ç—å –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ä–∞—Å–∫—Ä—ã—Ç–∏–∏ –≤–µ—Ç–∫–∏
- –ó–∞–≥—Ä—É–∂–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ –∑–∞–ø—Ä–æ—Å—É

### 17.3 –î–µ–±–∞—É–Ω—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –û–±–Ω–æ–≤–ª—è—Ç—å –ø–æ–∑–∏—Ü–∏—é –∫–∞—Ä—Ç–æ—á–µ–∫ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 500–º—Å –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ batch-–∑–∞–ø—Ä–æ—Å—ã

---

## 18. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### 18.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º —Å–≤—è–∑–µ–π
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –≥—Ä—É–ø–ø—É –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –∑–∞–¥–∞—á–∏ –≤ –≥—Ä—É–ø–ø–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω—ã –¥–æ—Å—Ç—É–ø–∞ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏

### 18.2 –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ñ–æ—Ä–º–∞—Ç—ã –≤—Å–µ—Ö –ø–æ–ª–µ–π –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ Entity
- –°–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å HTML –≤ –æ–ø–∏—Å–∞–Ω–∏—è—Ö –∑–∞–¥–∞—á
- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –¥–ª–∏–Ω—É —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª–µ–π

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–î–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è FlowTask –¥–ª—è Bitrix24 —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–æ–ª—å–∫–æ REST API –∏ Entity Storage —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π **Single Table Design**.

### –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è:

‚úÖ **Single Table Design (tflow_nodes)**
- –û–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- NAME —Ñ–æ—Ä–º–∞—Ç: `process_{processId}_node_{nodeType}-{nodeId}`
- DETAIL_TEXT —Ö—Ä–∞–Ω–∏—Ç JSON —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ —É–∑–ª–∞
- FILTER –ø–æ NAME –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

‚úÖ **–¢–æ–ª—å–∫–æ REST API**
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã Bitrix24
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –æ–±–ª–∞—á–Ω–æ–π –∏ –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏—è–º–∏
- Batch-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

‚úÖ **Pull & Push –¥–ª—è —Ä–µ–∞–ª—Ç–∞–π–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π**
- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è –∑–∞–¥–∞—á (ONTASKUPDATE, ONTASKCOMPLETE)
- –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω–∞ canvas
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –∏–∑ –ø—Ä–µ–¥–∑–∞–¥–∞—á

‚úÖ **ProcessSelector**
- –î–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∑–∞–¥–∞—á–∏ –±–µ–∑ –ø—Ä–æ—Ü–µ—Å—Å–∞
- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–ª–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É
- –ì–∏–±–∫–∏–µ –∏–º–µ–Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (—á–∏—Å–ª–∞ –∏–ª–∏ —Å—Ç—Ä–æ–∫–∏)

‚úÖ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
- –†–∞–Ω–Ω—è—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- FILTER –≤–º–µ—Å—Ç–æ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π
- –î–µ–±–∞—É–Ω—Å –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–π —É–∑–ª–æ–≤
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

‚úÖ **–ü–æ–¥–ø–∏—Å–∫–∞ –∏ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è**
- 30 –¥–Ω–µ–π –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ–±–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
- 500 —Ä—É–±/–º–µ—Å—è—Ü –ø–æ—Å–ª–µ –ø—Ä–æ–±–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏ —á–µ—Ä–µ–∑ app.option.get

‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≥—Ä—É–ø–ø –ø—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π/–≥—Ä—É–ø–ø

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤:

```
flowtask/
‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îú‚îÄ‚îÄ index.html                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –∑–∞–≥—Ä—É–∑–∫–∞ BX24 SDK
‚îÇ   ‚îî‚îÄ‚îÄ assets/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FlowCanvas.jsx         # –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å React Flow
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TaskNode.jsx           # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —É–∑–ª–∞ –∑–∞–¥–∞—á–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FutureNode.jsx         # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FutureTaskModal.jsx    # –ú–æ–¥–∞–ª–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProcessSelector.jsx    # –î–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SubscriptionCheck.jsx  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BitrixAPI.js           # –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è REST API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ EntityManager.js       # –†–∞–±–æ—Ç–∞ —Å tflow_nodes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TaskCreator.js         # –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –∏–∑ –ø—Ä–µ–¥–∑–∞–¥–∞—á
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TaskProcessMapping.js  # –ú–∞–ø–ø–∏–Ω–≥ –∑–∞–¥–∞—á–∏ -> –ø—Ä–æ—Ü–µ—Å—Å
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ PullClient.js          # Pull & Push –ø–æ–¥–ø–∏—Å–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ statusColors.js        # –¶–≤–µ—Ç–∞ —Å—Ç–∞—Ç—É—Å–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ debounce.js            # –£—Ç–∏–ª–∏—Ç–∞ –¥–µ–±–∞—É–Ω—Å–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ processHelpers.js      # Helpers –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ App.jsx
‚îú‚îÄ‚îÄ server/
‚îÇ   ‚îú‚îÄ‚îÄ webhook-handler.js         # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏–π –æ—Ç Bitrix24
‚îÇ   ‚îî‚îÄ‚îÄ subscription-manager.js    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏
‚îú‚îÄ‚îÄ install/
‚îÇ   ‚îî‚îÄ‚îÄ index.php                  # –°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ package.json
```

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞** ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ tflow_nodes, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è placement, –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
2. **–û—Ç–∫—Ä—ã—Ç–∏–µ –∑–∞–¥–∞—á–∏** ‚Üí –ü–æ–∏—Å–∫ –≤ tflow_nodes, –ø–æ–∫–∞–∑ ProcessSelector –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
3. **–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞** ‚Üí FILTER –ø–æ processId, batch –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
4. **–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏** ‚Üí –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É–∑–ª–∞ —Å edges –≤ tflow_nodes
5. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞** ‚Üí Pull&Push ‚Üí –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á
6. **–ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —É–∑–ª–æ–≤** ‚Üí –î–µ–±–∞—É–Ω—Å ‚Üí –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –≤ JSON
7. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞** ‚Üí –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —É–∑–ª–æ–≤ —Å –Ω–æ–≤—ã–º processId

### –û—Ç–ª–∏—á–∏—è –æ—Ç –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –¥–∏–∑–∞–π–Ω–∞:

| –ë—ã–ª–æ (Multi-Table) | –°—Ç–∞–ª–æ (Single-Table) |
|-------------------|----------------------|
| flowtask_cards | ‚ùå –£–¥–∞–ª–µ–Ω–æ |
| flowtask_links | ‚ùå –£–¥–∞–ª–µ–Ω–æ |
| flowtask_pretasks | ‚ùå –£–¥–∞–ª–µ–Ω–æ |
| flowtask_processes | ‚ùå –£–¥–∞–ª–µ–Ω–æ (—Ö—Ä–∞–Ω–∏—Ç—å –º–æ–∂–Ω–æ –∫–∞–∫ —É–∑–ª—ã —Å type="template") |
| **‚ûï tflow_nodes** | ‚úÖ **–û–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è –≤—Å–µ–≥–æ** |
| –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ | FILTER –ø–æ NAME –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ |
| JOIN'—ã –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ | –°–≤—è–∑–∏ –≤–Ω—É—Ç—Ä–∏ JSON (edges) |
| –°–ª–æ–∂–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è | –ü—Ä–æ—Å—Ç–æ–π CRUD —á–µ—Ä–µ–∑ entity.item.* |

### –î–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ:

- [ ] –®–∞–±–ª–æ–Ω—ã –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (—É–∑–ª—ã —Å type="template")
- [ ] –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞ (audit log)
- [ ] –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (JSON download/upload)
- [ ] –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (cleanupDeletedProcesses)
- [ ] –ì—Ä—É–ø–ø–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ —É–∑–ª–∞–º–∏ (batch update)
- [ ] –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (v1, v2...)

---

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞:** 2025-10-30
**–í–µ—Ä—Å–∏—è:** 1.0
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
