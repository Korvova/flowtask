/**
 * FlowCanvas - –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ–ª–æ—Ç–Ω–∞ React Flow
 * –í–ê–ñ–ù–û: Entity names ‚â§20 chars (Bitrix24 limitation)
 */
window.FlowCanvas = {
    render: function(task) {
        const React = window.React;
        const ReactDOM = window.ReactDOM;
        const RF = window.ReactFlow || window.reactflow;

        if (!React || !ReactDOM || !RF) {
            console.error('React –∏–ª–∏ ReactFlow –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
            return;
        }

        const { useState, useCallback, useEffect } = React;
        const { ReactFlow, Controls, Background, addEdge, applyNodeChanges, applyEdgeChanges } = RF;

        // –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
        function FlowApp() {
            const [nodes, setNodes] = useState([]);
            const [edges, setEdges] = useState([]);
            const [isLoading, setIsLoading] = useState(true);

            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
            useEffect(() => {
                console.log('üîß –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–ª—è –∑–∞–¥–∞—á–∏ ID:', task.id);
                loadProcessData();
            }, [task.id]);

            // –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞
            const loadProcessData = async () => {
                try {
                    // 1. –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–∑–∏—Ü–∏—é —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏
                    const taskPosition = await loadTaskPosition(task.id);

                    // 2. –°–æ–∑–¥–∞—ë–º —É–∑–µ–ª —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏
                    const mainNode = {
                        id: 'task-' + task.id,
                        type: 'taskNode',
                        position: taskPosition || { x: 250, y: 100 },
                        data: {
                            id: task.id,
                            title: task.title,
                            statusCode: task.status,
                            responsibleId: task.responsibleId,
                            isFuture: false,
                            isRealTask: true
                        }
                    };

                    // 3. –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏ (future tasks)
                    const futureTasks = await loadFutureTasks(task.id);
                    const futureNodes = futureTasks.map(ft => ({
                        id: ft.futureId,
                        type: 'taskNode',
                        position: { x: parseFloat(ft.positionX), y: parseFloat(ft.positionY) },
                        data: {
                            id: ft.futureId,
                            title: ft.title,
                            description: ft.description,
                            isFuture: true,
                            isRealTask: false,
                            conditionType: ft.conditionType
                        }
                    }));

                    // 4. –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–≤—è–∑–∏ (connections)
                    const connections = await loadConnections(task.id);
                    const loadedEdges = connections.map(conn => ({
                        id: 'edge-' + conn.sourceId + '-' + conn.targetId,
                        source: conn.sourceId,
                        target: conn.targetId,
                        type: conn.connectionType === 'future' ? 'default' : 'default',
                        className: conn.connectionType === 'future' ? 'future-edge' : ''
                    }));

                    setNodes([mainNode, ...futureNodes]);
                    setEdges(loadedEdges);
                    setIsLoading(false);

                    console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', {
                        nodes: [mainNode, ...futureNodes].length,
                        edges: loadedEdges.length
                    });

                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞:', error);
                    // –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ö–æ—Ç—è –±—ã –æ—Å–Ω–æ–≤–Ω—É—é –∑–∞–¥–∞—á—É
                    setNodes([{
                        id: 'task-' + task.id,
                        type: 'taskNode',
                        position: { x: 250, y: 100 },
                        data: {
                            id: task.id,
                            title: task.title,
                            statusCode: task.status,
                            responsibleId: task.responsibleId,
                            isFuture: false,
                            isRealTask: true
                        }
                    }]);
                    setIsLoading(false);
                }
            };

            // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–¥–∞—á–∏ –∏–∑ entity
            const loadTaskPosition = (taskId) => {
console.log("üîç –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–∑–∏—Ü–∏—é –¥–ª—è –∑–∞–¥–∞—á–∏ ID:", taskId);
                return new Promise((resolve) => {
                    BX24.callMethod('entity.item.get', {
                        ENTITY: 'tflow_task_pos',
                        FILTER: {
                            PROPERTY_taskId: taskId.toString()
                        }
                    }, (result) => {
                        if (result.error()) {
                            console.warn('–ü–æ–∑–∏—Ü–∏—è –∑–∞–¥–∞—á–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º default');
                            resolve(null);
                        } else {
                            const items = result.data();
                            if (items.length > 0) {
                                const item = items[0];
                                resolve({
                                    x: parseFloat(item.PROPERTY_VALUES.positionX),
                                    y: parseFloat(item.PROPERTY_VALUES.positionY)
                                });
                            } else {
                                resolve(null);
                            }
                        }
                    });
                });
            };

            // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–µ–¥–∑–∞–¥–∞—á –∏–∑ entity
            const loadFutureTasks = (taskId) => {
                return new Promise((resolve) => {
                    BX24.callMethod('entity.item.get', {
                        ENTITY: 'tflow_future_task',
                        FILTER: {}
                    }, (result) => {
                        if (result.error()) {
                            console.warn('–ü—Ä–µ–¥–∑–∞–¥–∞—á–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
                            resolve([]);
                        } else {
                            const items = result.data();
                            const futureTasks = items.map(item => ({
                                futureId: item.PROPERTY_VALUES.futureId,
                                title: item.PROPERTY_VALUES.title,
                                description: item.PROPERTY_VALUES.description,
                                groupId: item.PROPERTY_VALUES.groupId,
                                responsibleId: item.PROPERTY_VALUES.responsibleId,
                                conditionType: item.PROPERTY_VALUES.conditionType,
                                delayMinutes: item.PROPERTY_VALUES.delayMinutes,
                                positionX: item.PROPERTY_VALUES.positionX,
                                positionY: item.PROPERTY_VALUES.positionY,
                                isCreated: item.PROPERTY_VALUES.isCreated === 'true',
                                realTaskId: item.PROPERTY_VALUES.realTaskId
                            }));
                            resolve(futureTasks);
                        }
                    });
                });
            };

            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–≤—è–∑–µ–π –∏–∑ entity
            const loadConnections = (taskId) => {
                return new Promise((resolve) => {
                    BX24.callMethod('entity.item.get', {
                        ENTITY: 'tflow_connections',
                        FILTER: {}
                    }, (result) => {
                        if (result.error()) {
                            console.warn('–°–≤—è–∑–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
                            resolve([]);
                        } else {
                            const items = result.data();
                            const connections = items.map(item => ({
                                sourceId: item.PROPERTY_VALUES.sourceId,
                                targetId: item.PROPERTY_VALUES.targetId,
                                connectionType: item.PROPERTY_VALUES.connectionType
                            }));
                            resolve(connections);
                        }
                    });
                });
            };

            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ —É–∑–ª–∞ (—Å debounce)
            let savePositionTimeout = null;
            const saveNodePosition = (nodeId, position) => {
                console.log("

========================================");
                savePositionTimeout = setTimeout(() => {
                    console.log('üíæ –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–∑–∏—Ü–∏—é —É–∑–ª–∞:', nodeId, position);
                    console.log('üîπ Node ID:', nodeId);
                    console.log('üîπ Position:', 'x=' + position.x, 'y=' + position.y);
                    console.log('üîπ Task ID:', nodeId.replace('task-', ''));

                    if (nodeId.startsWith('task-')) {
                        const taskId = nodeId.replace('task-', '');

                        BX24.callMethod('entity.item.get', {
                            ENTITY: 'tflow_task_pos',
                            FILTER: {
                                PROPERTY_taskId: taskId
                            }
                        }, (getResult) => {
                            if (getResult.error()) {
                                console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–∑–∏—Ü–∏–∏:', getResult.error());
                                return;
                            }

                            const items = getResult.data();

                            console.log('üì• –†–µ–∑—É–ª—å—Ç–∞—Ç entity.item.get:');
                            console.log('   - –ù–∞–π–¥–µ–Ω–æ –∑–∞–ø–∏—Å–µ–π:', items.length);
                            if (items.length > 0) {
                                console.log('   - –ü–µ—Ä–≤–∞—è –∑–∞–ø–∏—Å—å ID:', items[0].ID);
                                console.log('   - PROPERTY_VALUES:', items[0].PROPERTY_VALUES);
                            }

                            if (items.length > 0) {
                                const itemId = items[0].ID;
                                BX24.callMethod('entity.item.update', {
                                console.log('üîÑ –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å ID:', itemId);
                                console.log('   - –ù–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: X=' + position.x + ', Y=' + position.y);
                                    ENTITY: 'tflow_task_pos',
                                    ID: itemId,
                                    PROPERTY_VALUES: {
                                        positionX: position.x.toString(),
                                        positionY: position.y.toString()
                                    }
                                }, (updateResult) => {
                                    if (updateResult.error()) {
                                        console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏:', updateResult.error());
                                    } else {
                                        console.log('‚úÖ –ü–æ–∑–∏—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞');
                                    }
                                });
                            } else {
                                BX24.callMethod('entity.item.add', {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                    ENTITY: 'tflow_task_pos',
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                    NAME: 'Position for task ' + taskId,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                    PROPERTY_VALUES: {
                                        taskId: taskId,
                                        positionX: position.x.toString(),
                                        positionY: position.y.toString()
                                    }
                                }, (addResult) => {
                                    if (addResult.error()) {
                                        console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏:', addResult.error());
                                    } else {
                                        console.log('‚úÖ –ü–æ–∑–∏—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞:', addResult.data());
                                    }
                                });
                            }
                        });
                    }
                }, 500);
            };

            const onNodesChange = useCallback((changes) => {
                setNodes((nds) => {
                    const updatedNodes = applyNodeChanges(changes, nds);
                    changes.forEach(change => {
                        if (change.type === 'position' && change.position && !change.dragging) {
                            saveNodePosition(change.id, change.position);
                        }
                    });
                    return updatedNodes;
                });
            }, []);

            const onEdgesChange = useCallback((changes) => {
                setEdges((eds) => applyEdgeChanges(changes, eds));
            }, []);

            const onConnect = useCallback((connection) => {
                console.log('üîó –ù–æ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ:', connection);

                if (typeof window.TaskModal !== 'undefined') {
                    window.TaskModal.show({
                        sourceId: connection.source,
                        targetId: connection.target,
                        taskId: task.id,
                        onSave: (futureTaskData) => {
                            saveFutureTask(futureTaskData, connection);
                        }
                    });
                } else {
                    console.error('TaskModal –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
                }
            }, [task.id]);

            const saveFutureTask = (futureTaskData, connection) => {
                console.log('üíæ –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–µ–¥–∑–∞–¥–∞—á—É:', futureTaskData);

                const futureId = 'future-' + Date.now();

                BX24.callMethod('entity.item.add', {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    ENTITY: 'tflow_future_task',
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    NAME: futureTaskData.title,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    PROPERTY_VALUES: {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        futureId: futureId,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        title: futureTaskData.title,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        description: futureTaskData.description,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        groupId: futureTaskData.groupId.toString(),
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        responsibleId: futureTaskData.responsibleId.toString(),
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        conditionType: futureTaskData.conditionType,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        delayMinutes: futureTaskData.delayMinutes.toString(),
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        positionX: futureTaskData.positionX.toString(),
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        positionY: futureTaskData.positionY.toString(),
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        isCreated: 'false',
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        realTaskId: ''
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    }
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                }, (result) => {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    if (result.error()) {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–µ–¥–∑–∞–¥–∞—á–∏:', result.error());
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        return;
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    }
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);

                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    console.log('‚úÖ –ü—Ä–µ–¥–∑–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞:', result.data());
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);

                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    BX24.callMethod('entity.item.add', {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        ENTITY: 'tflow_connections',
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        NAME: 'Connection ' + connection.source + ' -> ' + futureId,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        PROPERTY_VALUES: {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                            sourceId: connection.source,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                            targetId: futureId,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                            connectionType: 'future'
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        }
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    }, (connResult) => {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        if (connResult.error()) {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                            console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å–≤—è–∑–∏:', connResult.error());
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        } else {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                            console.log('‚úÖ –°–≤—è–∑—å —Å–æ–∑–¥–∞–Ω–∞');
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                            loadProcessData();
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        }
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    });
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                });
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
            };
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);

                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
            useEffect(() => {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                console.log('üîî –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ ID:', task.id);
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);

                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                const pollInterval = setInterval(() => {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    BX24.callMethod('tasks.task.get', {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        taskId: task.id,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        select: ['ID', 'TITLE', 'STATUS']
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    }, (result) => {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        if (result.error()) return;
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);

                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        const taskData = result.data();
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        if (taskData && taskData.task) {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                            const currentStatus = taskData.task.status;
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);

                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                            setNodes((currentNodes) => {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                const currentNode = currentNodes.find(n => n.id === 'task-' + task.id);
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                if (currentNode && currentNode.data.statusCode != currentStatus) {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                    console.log('üîÑ –°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–∏–ª—Å—è:', currentNode.data.statusCode, '‚Üí', currentStatus);
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);

                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                    return currentNodes.map((node) => {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                        if (node.id === 'task-' + task.id) {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                            return {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                                ...node,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                                data: {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                                    ...node.data,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                                    statusCode: currentStatus,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                                    title: taskData.task.title || node.data.title
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                                }
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                            };
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                        }
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                        return node;
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                    });
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                }
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                                return currentNodes;
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                            });
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        }
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    });
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                }, 3000);
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);

                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                return () => {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    clearInterval(pollInterval);
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    console.log('üßπ –û—á–∏—Å—Ç–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫');
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                };
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
            }, [task.id]);
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);

                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
            const nodeTypes = {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                taskNode: window.TaskNode
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
            };
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);

                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
            if (isLoading) {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                return React.createElement('div', {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    style: {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        display: 'flex',
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        alignItems: 'center',
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        justifyContent: 'center',
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        height: '100vh',
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        fontSize: '24px'
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    }
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                }, '‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...');
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
            }
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);

                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
            return React.createElement('div', {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                style: {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    width: '100%',
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    height: '100vh',
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    background: '#f5f7fa'
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                }
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
            },
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                React.createElement(ReactFlow, {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    nodes: nodes,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    edges: edges,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    onNodesChange: onNodesChange,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    onEdgesChange: onEdgesChange,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    onConnect: onConnect,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    nodeTypes: nodeTypes,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    fitView: true,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    minZoom: 0.5,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    maxZoom: 1.5,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    connectionMode: 'loose',
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    defaultEdgeOptions: {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        type: 'default',
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        animated: false
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    }
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                },
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    React.createElement(Controls),
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    React.createElement(Background, {
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        variant: 'dots',
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        gap: 12,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        size: 1,
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                        color: '#ddd'
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                    })
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
                )
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
            );
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
        }
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);

                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
        const root = ReactDOM.createRoot(document.getElementById('root'));
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
        root.render(React.createElement(FlowApp));
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);

                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
        console.log('‚úÖ FlowCanvas rendered');
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
    }
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
};
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);

                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
console.log('‚úÖ FlowCanvas component loaded');
                                console.log('‚ûï –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å');
                                console.log('   - Task ID:', taskId);
                                console.log('   - Position: X=' + position.x + ', Y=' + position.y);
